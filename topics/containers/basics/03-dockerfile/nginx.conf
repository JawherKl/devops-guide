# =============================================================================
# nginx.conf — Companion config for basics/03-dockerfile/nginx.dockerfile
# =============================================================================
# Copy this to your project alongside nginx.dockerfile.
# Used with: docker build -f nginx.dockerfile -t my-site .
# =============================================================================

server {
    listen 80;
    server_name _;

    root /usr/share/nginx/html;
    index index.html;

    # ── Health check ──────────────────────────────────────────────────────────
    location /health {
        access_log off;
        return 200 'ok\n';
        add_header Content-Type text/plain;
    }

    # ── Static files — with caching ───────────────────────────────────────────
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }

    # ── SPA fallback — route all requests to index.html ───────────────────────
    location / {
        try_files $uri $uri/ /index.html;
    }
}